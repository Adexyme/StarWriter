{"version":3,"file":"FileHandler.js","sourceRoot":"","sources":["../../src/FileHandler.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,+DAA4D;AAE5D,6CAA0C;AAC1C,MAAa,WAAW;;AAAxB,kCAuEC;AArEe,sBAAU,GAAyB,IAAI,CAAC;AACxC,yBAAa,GACzB;;QACE,MAAM,OAAO,GAAG;YACd,KAAK,EAAE;gBACL;oBACE,WAAW,EAAE,YAAY;oBACzB,MAAM,EAAE;wBACN,WAAW,EAAE,CAAC,OAAO,CAAC;qBACvB;iBACF;aACF;SACF,CAAC;QAEF,MAAM,MAAM,GAAG,MAAM,MAAM,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;QACxD,OAAO,MAAM,CAAC;IAChB,CAAC;CAAA,CAAC;AACU,yBAAa,GAAG;;QAC5B,yCAAmB,CAAC,sBAAsB,CAAC;YACzC,uBAAU,CAAC,aAAa;YACxB,uBAAU,CAAC,eAAe;SAC3B,CAAC,CAAC;QACH;;;;;;;YAOI;QACJ,IAAI,WAAW,CAAC,UAAU,KAAK,IAAI,EAAE;YACnC,MAAM,QAAQ,GAAG,MAAM,WAAW,CAAC,UAAU,CAAC,cAAc,EAAE,CAAC;YAC/D,MAAM,SAAS,GAAG,WAAW,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;YACxD,MAAM,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;YAChC,mCAAmC;YACnC,MAAM,QAAQ,CAAC,KAAK,EAAE,CAAC;YACvB,WAAW,CAAC,UAAU,GAAG,IAAI,CAAC;YAC9B,WAAW,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;YACxC,WAAW,CAAC,WAAW,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;SAC/C;QAED,yCAAmB,CAAC,qBAAqB,CAAC;YACxC,uBAAU,CAAC,aAAa;YACxB,uBAAU,CAAC,eAAe;SAC3B,CAAC,CAAC;QACH;;;YAGI;QACJ;;;YAGI;IACN,CAAC;CAAA,CAAC;AACY,oBAAQ,GAAG;;QACvB,IAAI,WAAW,CAAC,UAAU,KAAK,IAAI,EAAE;YACnC,WAAW,CAAC,UAAU,GAAG,MAAM,WAAW,CAAC,aAAa,EAAE,CAAC;SAC5D;QAED,MAAM,QAAQ,GAAG,MAAM,WAAW,CAAC,UAAU,CAAC,cAAc,EAAE,CAAC;QAC/D,MAAM,SAAS,GAAG,WAAW,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;QACxD,MAAM,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QAChC,mCAAmC;QACnC,MAAM,QAAQ,CAAC,KAAK,EAAE,CAAC;QAEvB,gDAAgD;QAEhD,gBAAgB;IAClB,CAAC;CAAA,CAAC","sourcesContent":["import { ElementClassManager } from \"./ElementClassManager\";\r\nimport { HtmlHandler } from \"./HtmlHandler\";\r\nimport { UtilityCls } from \"./UtilityCls\";\r\nexport class FileHandler {\r\n  public static HtmlHandler: HtmlHandler;\r\n  public static fileHandle: FileSystemFileHandle = null;\r\n  public static getFileHandle =\r\n    async function (): Promise<FileSystemFileHandle> {\r\n      const options = {\r\n        types: [\r\n          {\r\n            description: \"Test files\",\r\n            accept: {\r\n              \"text/html\": [\".html\"],\r\n            },\r\n          },\r\n        ],\r\n      };\r\n\r\n      const handle = await window.showSaveFilePicker(options);\r\n      return handle;\r\n    };\r\n  public static createNewFile = async function () {\r\n    ElementClassManager.disableElements4Groups([\r\n      UtilityCls.menuContainer,\r\n      UtilityCls.tagBtnContainer,\r\n    ]);\r\n    /*ElementClassManager.addAClass4Groups(\r\n      [UtilityCls.spinnerContainer],\r\n      \"visible\"\r\n    );\r\n    //ElementClassManager.removeAClass4Groups(\r\n      [UtilityCls.spinnerContainer],\r\n      \"invisible\"\r\n    );*/\r\n    if (FileHandler.fileHandle !== null) {\r\n      const writable = await FileHandler.fileHandle.createWritable();\r\n      const mkdOutput = FileHandler.HtmlHandler.getMarkdown();\r\n      await writable.write(mkdOutput);\r\n      //close the stream for the old file\r\n      await writable.close();\r\n      FileHandler.fileHandle = null;\r\n      FileHandler.HtmlHandler.setMarkdown(\"\");\r\n      FileHandler.HtmlHandler.setMarkdownOutput(\"\");\r\n    }\r\n\r\n    ElementClassManager.enableElements4Groups([\r\n      UtilityCls.menuContainer,\r\n      UtilityCls.tagBtnContainer,\r\n    ]);\r\n    /*ElementClassManager.addAClass4Groups(\r\n      [UtilityCls.spinnerContainer],\r\n      \"invisible\"\r\n    );*/\r\n    /*ElementClassManager.removeAClass4Groups(\r\n      [UtilityCls.spinnerContainer],\r\n      \"visible\"\r\n    );*/\r\n  };\r\n  public static saveFile = async function () {\r\n    if (FileHandler.fileHandle === null) {\r\n      FileHandler.fileHandle = await FileHandler.getFileHandle();\r\n    }\r\n\r\n    const writable = await FileHandler.fileHandle.createWritable();\r\n    const mkdOutput = FileHandler.HtmlHandler.getMarkdown();\r\n    await writable.write(mkdOutput);\r\n    //close the stream for the old file\r\n    await writable.close();\r\n\r\n    //await FileHandler.fileWriteableStream.close();\r\n\r\n    //return handle;\r\n  };\r\n}\r\n"]}